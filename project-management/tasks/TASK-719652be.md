# [TASK-719652be] Purge all database references from Octopoid

ROLE: implement
PRIORITY: P1
BRANCH: feature/client-server-architecture
CREATED: 2026-02-13T00:00:00Z
CREATED_BY: human
EXPEDITE: false
SKIP_PR: true

## Context

Octopoid v2.0 moved to a Cloudflare Workers + D1 API-only architecture. The local SQLite database (`orchestrator/db.py`, `state.db`, `is_db_enabled()` checks) is dead code from previous versions. 1420 occurrences across 83 files need purging.

See: `project-management/drafts/purge-db-references.md`

## Phases

### Phase 1: Delete dead modules
- Delete `orchestrator/db.py`
- Delete `tests/test_db.py`
- Delete `orchestrator/migrate.py`
- Delete `project-management/drafts/sqlite-proposal.md`

### Phase 2: Remove `is_db_enabled()` and config
- Delete `is_db_enabled()` from `orchestrator/config.py`
- Remove `database:` section from `.octopoid/config.yaml`
- Fix all callers â€” remove conditional branches that check `is_db_enabled()`

### Phase 3: Clean production code
- Remove all `from .db import` lines
- Remove db-conditional branches in: `queue_utils.py`, `planning.py`, `reports.py`, `approve_orch.py`, `review_orch.py`, `scheduler.py`
- Clean roles: `rebaser.py`, `pre_check.py`, `gatekeeper.py`, `orchestrator_impl.py`, `breakdown.py`, `recycler.py`

### Phase 4: Clean test code
- Remove db fixtures from `tests/conftest.py`
- Update mocks in: `test_queue_utils.py`, `test_rebaser.py`, `test_approve_orch.py`, `test_review_orch.py`, `test_review_system.py`, `test_gatekeeper_wiring.py`, `test_orchestrator_impl.py`, and others

### Phase 5: Clean scripts
- Update or delete scripts that use `orchestrator.db`: `approve_task.py`, `cancel_task.py`, `move_task.py`, `update_task.py`, `unclaim_task.py`, `register_existing_drafts.py`

### Phase 6: Clean docs and commands
- Remove `database:` mentions from `DEVELOPMENT_RULES.md`, `README.md`
- Clean `docs/architecture.md`, `docs/architecture-v2.md`, `docs/migration-v2.md`
- Clean `commands/agent/*.md`

### Phase 7: Verify
- Run full test suite
- Grep for remaining db/sqlite references to confirm clean

## Acceptance Criteria

- [ ] `orchestrator/db.py`, `tests/test_db.py`, `orchestrator/migrate.py` deleted
- [ ] `is_db_enabled()` removed from codebase
- [ ] No `from .db import` or `from orchestrator.db` anywhere
- [ ] No `database:` config section in `.octopoid/config.yaml`
- [ ] No `sqlite` or `state.db` references in production code
- [ ] All tests pass
- [ ] Grep for `is_db_enabled|orchestrator\.db|from \.db|sqlite|state\.db` returns zero hits in `orchestrator/` and `tests/`
